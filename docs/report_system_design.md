# Colony Detection SAM 3.0 交互式报告系统设计

本文档描述如何在项目中生成并组织交互式可视化报告。内容涵盖输出目录结构、前端组件设计、数据字段约定以及各级页面的主要功能。

## 1. 文件结构与命名规范
- **总览页面**：分析输出根目录生成 `index.html`，链接各处理条件和重复实验。
- **Replicate 报告**：每个重复实验的结果存放在独立子目录，如 `replicate_01/report.html`，同时保存 JSON 及图像等资源。
- **条件汇总页**：所有条件的汇总页面放在 `conditions/` 下，例如 `conditions/Control.html`。
- **公共资源**：统一的脚本和样式置于 `assets/` 目录，或通过 CDN 引用。

## 2. 前端框架与组件逻辑
报告推荐使用 Vue.js 构建。主要组件包括：
- **ColonyImage**：展示菌落原图及掩膜交互层。
- **Tooltip/DetailPanel**：在鼠标悬停时显示菌落信息。
- **Charts**：基于 Chart.js 或 Plotly 绘制统计图表。
组件化设计便于复用并保持页面结构清晰。

## 3. 数据字段结构与预处理
每个 replicate 目录需包含标准化的 `detailed_results.json`，其中记录：
- `id`：菌落编号
- `well_position`：孔板位置
- `features`：面积、圆形度等量化特征
- `scores`：模型评分
- `phenotype`：分类结果
此外还需存放原始图像和掩膜数据。脚本在生成报告时应将掩膜转换为坐标数组，准备好条件汇总 JSON 以供前端直接使用。

## 4. 报告页面功能概览
- **Replicate 页面**：并排展示正、反面图像，支持切换掩膜显示并悬停查看详细指标。
- **条件汇总页**：展示该条件下所有 replicates 的统计图表和代表性缩略图，可下载原始数据。
- **总览首页**：提供实验介绍、导航链接及跨条件比较图表。

## 5. 样式与交互建议
- 统一浅色背景和深色文字，掩膜使用半透明填充与实线描边。
- Tooltip 采用浮层样式，并在鼠标移出时稍作延迟隐藏。
- 页面布局使用响应式设计，在窄屏下图像可自动纵向排列。

## 6. 报告生成脚本
编写 `integrate_report.py` 自动遍历分析输出，读取各 replicate 的 JSON/CSV 数据并渲染 Jinja2 模板生成 HTML。步骤包括：
1. 发现并归类所有 replicate 目录
2. 加载数据并计算汇总指标
3. 渲染 `replicate`, `condition` 和 `index` 模板
4. 复制静态资源到输出目录
执行完成后即可离线浏览 `index.html`。

以上设计能够提供结构清晰且易于维护的报告系统，并通过交互式图表与掩膜高亮功能，帮助研究人员深入分析菌落检测结果。
